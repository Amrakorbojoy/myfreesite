/*!CK:3345512830!*//*1445284236,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["\/kERb"]); }

__d('MXUIButton.react',['React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=h.PropTypes,l=h.createClass({displayName:'MXUIButton',propTypes:{label:k.string,size:k.oneOf(['small','medium','large']),use:k.oneOf(['special','primary','normal'])},getDefaultProps:function(){return {use:'normal',size:'small'};},getClassListForAttribute:function(m){var n={size:{medium:"_56bw",large:"_56bx"},use:{special:"_56bv",primary:"_56bu",normal:"_56bt"}};return n[m][this.props[m]];},render:function(){var m=j("_56bs",this.getClassListForAttribute('size'),this.getClassListForAttribute('use'));if(this.props.href)return (h.createElement('a',babelHelpers._extends({},this.props,{href:this.props.href,className:j(this.props.className,m)}),this.props.children||this.props.label));return (h.createElement('button',babelHelpers._extends({},this.props,{type:'submit',className:j(this.props.className,m)}),this.props.children||this.props.label));}});f.exports=l;},null);
__d("arrayContains",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){return i.indexOf(j)!==-1;}f.exports=h;},null);
__d("cssURL",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){return "url('"+i.replace(/(\\|\s|\(|\)|'|\")/g,'\\$1')+"')";}f.exports=h;},null);
__d('DOMContainer.react',['React','ReactDOM','invariant','isNode'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=h.PropTypes,m=h.createClass({displayName:'DOMContainer',propTypes:{display:l.oneOf(['inline','block'])},getDefaultProps:function(){return {display:'inline'};},getDOMChild:function(){var n=this.props.children;!k(n)?j(0):undefined;return n;},shouldComponentUpdate:function(n,o){return n.children!==this.props.children;},componentDidMount:function(){i.findDOMNode(this).appendChild(this.getDOMChild());},componentDidUpdate:function(){var n=i.findDOMNode(this);while(n.lastChild)n.removeChild(n.lastChild);n.appendChild(this.getDOMChild());},render:function(){if(this.props.display==='block')return h.createElement('div',this.props,undefined);return h.createElement('span',this.props,undefined);}});f.exports=m;},null);
__d('LeftRight.react',['React','ReactChildren','cx','invariant','keyMirror','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=l({left:true,right:true,both:true});function o(q){!(q&&(q.length===1||q.length===2))?k(0):undefined;}var p=h.createClass({displayName:'LeftRight',render:function(){var q=[];i.forEach(this.props.children,function(y){q.push(y);},this);o(q);var r=this.props.direction||n.both,s=r===n.both,t=s||r===n.left?"_ohe lfloat":'',u=s||r===n.right?"_ohf rfloat":'',v=h.createElement('div',{key:'left',className:t},q[0]),w=q.length<2?null:h.createElement('div',{key:'right',className:u},q[1]),x=r===n.right&&w?[w,v]:[v,w];return (h.createElement('div',babelHelpers._extends({},this.props,{className:m(this.props.className,"clearfix")}),x));}});p.DIRECTION=n;f.exports=p;},null);
__d('FacebarResultsTextHighlighter',['React'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={highlightAddedChars:function(j,k){var l=[],m=k.trim().toLowerCase(),n=j.trim().split(' ');while(n.length>0&&m.length>0){var o=n.shift(),p=m.indexOf(o),q=k,r=q.length;if(p>0){var s=k.substr(0,p);q=[h.createElement('strong',{key:this._generateKey(s)},s),o];r=p+o.length;}else if(p===0){r=o.length;q=k.substr(0,r);}l.push(q);m=m.substr(r);k=k.substr(r);}if(k.length!==0)l.push(h.createElement('strong',{key:this._generateKey(k)},k));return l;},_generateKey:function(j){return 'highlight_'+j+Math.random();}};f.exports=i;},null);
__d('TokenizeUtil',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=/[ ]+/g,i=/[^ ]+/g,j=new RegExp(k(),'g');function k(){return '[.,+*?$|#{}()\'\\^\\-\\[\\]\\\\\\/!@%"~=<>_:;'+'\u30fb\u3001\u3002\u3008-\u3011\u3014-\u301f\uff1a-\uff1f\uff01-\uff0f'+'\uff3b-\uff40\uff5b-\uff65\u2E2E\u061f\u066a-\u066c\u061b\u060c\u060d'+'\uFD3e\uFD3F\u1801\u0964\u104a\u104b\u2010-\u2027\u2030-\u205e'+'\u00a1-\u00b1\u00b4-\u00b8\u00ba\u00bb\u00bf]';}var l={},m={a:"\u0430 \u00e0 \u00e1 \u00e2 \u00e3 \u00e4 \u00e5 \u0101",b:"\u0431",c:"\u0446 \u00e7 \u010d",d:"\u0434 \u00f0 \u010f \u0111",e:"\u044d \u0435 \u00e8 \u00e9 \u00ea \u00eb \u011b \u0113",f:"\u0444",g:"\u0433 \u011f \u0123",h:"\u0445 \u0127",i:"\u0438 \u00ec \u00ed \u00ee \u00ef \u0131 \u012b",j:"\u0439",k:"\u043a \u0138 \u0137",l:"\u043b \u013e \u013a \u0140 \u0142 \u013c",m:"\u043c",n:"\u043d \u00f1 \u0148 \u0149 \u014b \u0146",o:"\u043e \u00f8 \u00f6 \u00f5 \u00f4 \u00f3 \u00f2",p:"\u043f",r:"\u0440 \u0159 \u0155",s:"\u0441 \u015f \u0161 \u017f",t:"\u0442 \u0165 \u0167 \u00fe",u:"\u0443 \u044e \u00fc \u00fb \u00fa \u00f9 \u016f \u016b",v:"\u0432",y:"\u044b \u00ff \u00fd",z:"\u0437 \u017e",ae:"\u00e6",oe:"\u0153",ts:"\u0446",ch:"\u0447",ij:"\u0133",sh:"\u0448",ss:"\u00df",ya:"\u044f"};for(var n in m){var o=m[n].split(' ');for(var p=0;p<o.length;p++)l[o[p]]=n;}var q={};function r(x){return x?x.replace(j,' '):'';}function s(x){x=x.toLowerCase();var y='',z='';for(var aa=x.length;aa--;){z=x.charAt(aa);y=(l[z]||z)+y;}return y.replace(h,' ');}function t(x){var y=[],z=i.exec(x);while(z){z=z[0];y.push(z);z=i.exec(x);}return y;}function u(x,y){if(!q.hasOwnProperty(x)){var z=s(x),aa=r(z);q[x]={value:x,flatValue:z,tokens:t(aa),isPrefixQuery:aa&&aa[aa.length-1]!=' '};}if(y&&typeof q[x].sortedTokens=='undefined'){q[x].sortedTokens=q[x].tokens.slice();q[x].sortedTokens.sort(function(ba,ca){return ca.length-ba.length;});}return q[x];}function v(x,y,z){var aa=u(y,x=='prefix'),ba=x=='prefix'?aa.sortedTokens:aa.tokens,ca=u(z).tokens,da={},ea=aa.isPrefixQuery&&x=='query'?ba.length-1:null,fa=function(ga,ha){for(var ia=0;ia<ca.length;++ia){var ja=ca[ia];if(!da[ia]&&(ja==ga||(x=='query'&&ha===ea||x=='prefix')&&ja.indexOf(ga)===0))return da[ia]=true;}return false;};return Boolean(ba.length&&ba.every(fa));}var w={flatten:s,parse:u,getPunctuation:k,isExactMatch:v.bind(null,'exact'),isQueryMatch:v.bind(null,'query'),isPrefixMatch:v.bind(null,'prefix'),tokenize:t};f.exports=w;},null);
__d('MLoginFormError',['CSS','Stratcom','cx','invariant'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l="_3qsy",m="_3qs-",n='login-form-input';function o(q){var r=q.getNode(n);h.removeClass(r,m);}var p={set:function(q,r){!(r!==null)?k(0):undefined;h.addClass(q,l);h.addClass(q,m);i.listen('input',n,o);}};f.exports=p;},null);
__d('MContentSearchFilter',['Stratcom'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={setFilters:function(j){this.markup=j;h.invoke('m-content-search-filter-update',null,{markup:j});},getFilters:function(){var j=this.markup;this.markup=null;return j;}};f.exports=i;},null);
__d('MGraphSearchUtils',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={normalizeQuery:function(i){return i.replace(/^.*\/\//,'').replace(/\//g,'%2F').replace(/\\/g,'%5C').replace(/ /g,'+').replace(/\?/g,'3F').replace(/#/g,'%23');}};f.exports=h;},null);
__d('MGraphSearchCompositeSource',['TypeaheadCompositeSource'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i,j;i=babelHelpers.inherits(k,h);j=i&&i.prototype;k.prototype.mergeResults=function(l,m){'use strict';var n=j.mergeResults.call(this,l,m);if(!n||!this.$MGraphSearchCompositeSource1||n.some(function(ea){return ea.type==='trending';})||n.some(function(ea){return ea.isRecentSearch;}))return n;n.length=Math.min(n.length,this.$MGraphSearchCompositeSource1.maxResults);if(this.$MGraphSearchCompositeSource1.enableLegacyStyleBucketization)return this.bucketResults(n);var o=false,p=n[0];if(p&&(p.bootstrapped||p.bootstrap||p.type==='user'&&p.cost<this.$MGraphSearchCompositeSource1.minCostForUserToSurfaceAtTop))o=true;var q=false;for(var r=0;r<this.$MGraphSearchCompositeSource1.maxPositionOfEntityToDivideKeywords;r++)if(n[r]&&n[r].type!=='keyword')q=true;var s=[],t=[],u=[],v=null;for(var w=0;w<n.length;w++){v=n[w];if(!(v.bootstrapped&&this.$MGraphSearchCompositeSource1.keepBootstrapped)&&v.type in this.$MGraphSearchCompositeSource1.filterOutTypes)continue;if(v.type==='keyword'){if(!o&&(!q||t.length<this.$MGraphSearchCompositeSource1.maxKeywordAboveEntities)){t.push(v);}else u.push(v);}else s.push(v);}if(this.$MGraphSearchCompositeSource1.overrideKWRankingBehavior){var x,y=t;y.push.apply(y,u);var z=y.slice(0,this.$MGraphSearchCompositeSource1.numKeywordsAboveEntities),aa=y.slice(this.$MGraphSearchCompositeSource1.numKeywordsAboveEntities);n=z;(x=n).push.apply(x,s);if(this.$MGraphSearchCompositeSource1.hasKeywordsBelowEntities){var ba;(ba=n).push.apply(ba,aa);}}else{var ca,da;n=t;(ca=n).push.apply(ca,s);(da=n).push.apply(da,u);}return n;};k.prototype.bucketResults=function(l){'use strict';if(!l.length)return l;var m,n,o=[],p={};for(var q=0,r=l.length;q<r;q++){m=l[q];n=this.getBucketType(m);if(!p[n]){o.push(n);p[n]=[m];}else p[n].push(m);}return o.reduce(function(s,t){return s.concat(p[t]);},[]);};k.prototype.getBucketType=function(l){'use strict';if(l.type==='keyword'||l.is_grammar)return 'keyword';return 'entity';};k.prototype.setConfig=function(l){'use strict';this.$MGraphSearchCompositeSource1=l;};function k(){'use strict';i.apply(this,arguments);}f.exports=k;},null);
__d('MGraphSearchTypeaheadHeaders',['fbt','keyMirror'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=i({PYMK:null,RECENT:null,SUGGESTED:null,TOP_MATCHES:null,TRENDING:null,GROUP_POPULAR:null,GROUP_SEARCH:null,SUGGESTED_GLOBAL:null}),k={PYMK:h._("People you may know"),RECENT:h._("Recent Searches"),SUGGESTED:h._("Searches"),TOP_MATCHES:h._("Top Matches"),TRENDING:h._("Trending"),GROUP_POPULAR:h._("Popular in this Group"),GROUP_SEARCH:h._("Search this group"),SUGGESTED_GLOBAL:h._("Search all of Facebook")};f.exports={Types:j,Labels:k};},null);
__d('MGraphSearchTypeaheadBucketizer',['MGraphSearchTypeaheadHeaders'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=h.Types,j=10;function k(m){if(m.isTrending){return i.TRENDING;}else if(m.isRecentSearch){return i.RECENT;}else if(m.isPYMK){return i.PYMK;}else if(m.isScoped){return m.isNullStateSuggestion?i.GROUP_POPULAR:i.GROUP_SEARCH;}else if(m.type==='keyword'){return i.SUGGESTED;}else return i.TOP_MATCHES;}function l(m){'use strict';m=m||{};this.maxResults=m.maxResults||j;}l.prototype.bucketize=function(m){'use strict';var n={},o=Math.min(m.length,this.maxResults);for(var p=0;p<o;p++){var q=m[p],r=k(q);if(!n[r])n[r]=[];n[r].push(q);}return n;};f.exports=l;},null);
__d('MGraphSearchTypeaheadOnDemandSource',['MTypeaheadOnDemandSource','TokenizeUtil','createArrayFromMixed','Stratcom'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m,n='graph-search-entry-point';l=babelHelpers.inherits(o,h);m=l&&l.prototype;function o(p,q){'use strict';m.constructor.call(this,p,q);this.enableImmediateReturnOfCachedResults=true;this.setNormalizer(function(r){return r.toLowerCase();});this.setSanitizer(function(r){return r;});this.queryCache={};this.groupID=null;this.isScoped=false;k.listen('setCurrentProfileID',n,(function(event){if(event.getData().profileID!==this.groupID){this.groupID=event.getData().profileID;this.clearCache();}}).bind(this));}o.prototype.getMatchedResults=function(p){'use strict';var q=p.toLowerCase();while(q.length>0&&!(q in this.queryCache))q=q.substr(0,q.length-1);if(!q)return [];var r=[];if(q===p){r=this.queryCache[p];return this.renderNodes(p,r);}for(var s=0;s<this.queryCache[q].length;s++){var t=this.queryCache[q][s];if(i.isQueryMatch(p,this._raw[t].display))r.push(t);}return this.renderNodes(p,r);};o.prototype.addToLookup=function(p,q){'use strict';this.addToQueryCache(p,q);};o.prototype.addResult=function(p,q){'use strict';var r=p.uid;if(!(r in this._raw)){p=(this.getTransformer()||this._defaultTransformer)(p);this._raw[r]=p;}this._raw[r].idx=p.idx;this.addToQueryCache(r,q);};o.prototype.addToQueryCache=function(p,q){'use strict';if(!this.queryCache[q])this.queryCache[q]=[];if(this.queryCache[q].indexOf(p)===-1)this.queryCache[q].push(p);};o.prototype.setGroupID=function(p){'use strict';this.groupID=p;};o.prototype.setIsScoped=function(p){'use strict';this.isScoped=p;};o.prototype.getAuxiliaryData=function(){'use strict';if(this.isScoped&&this.groupID!=null)return {group_id:this.groupID};};o.prototype.tokenize=function(p){'use strict';var q=m.tokenize.call(this,p);if(q[q.length-1]==='')q.pop();return q;};o.prototype.ondata=function(p,q,r){'use strict';if(r.payload){if(q)q=q.toLowerCase();m.ondata.call(this,p,q,j(r.payload));}else{this.invoke('req_recv',0);this.invoke('complete');}};o.prototype.getTransformer=function(){'use strict';return function(p){if(p.type==='keyword')return {cost:p.cost,idx:p.idx,display:p.text,name:p.text,type:p.untranslated_type||p.type,id:p.uid,uri:p.path,saved_context:p.saved_context,logInfo:p.logInfo,subtext:p.subtext,is_grammar:p.grammar_type!=null,isScoped:p.is_scoped};return {name:p.text,uri:p.path,id:p.uid,display:p.display||p.text,photo:p.photo,category:p.category,cost:p.cost,idx:p.idx,tokens:p.tokens,type:p.untranslated_type||p.type,verticalType:p.vertical_type,subtext:p.subtext,saved_context:p.saved_context,isVerified:p.is_verified,showGrayCheck:p.show_gray_check,logInfo:p.logInfo};};};o.prototype.clearCache=function(){'use strict';m.clearCache.call(this);this.queryCache={};};f.exports=o;},null);
__d('MGraphSearchTypeaheadTouchSource',['MTypeaheadTouchSource','createArrayFromMixed'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j,k;j=babelHelpers.inherits(l,h);k=j&&j.prototype;l.prototype.ondata=function(m){'use strict';this.setNormalizer(function(n){return n.toLowerCase();});k.ondata.call(this,i(m.payload||m));};l.prototype.checkFragmentMatches=function(m,n,o,p){'use strict';if(m.substr(0,n.length)!==n)return false;var q=o[o.length-1]!==' ';if(!q||n!==p)return m==n;return true;};l.prototype.tokenize=function(m){'use strict';var n=k.tokenize.call(this,m);if(n[n.length-1]==='')n.pop();return n;};l.prototype.getTransformer=function(){'use strict';return function(m){return {name:m.text,uri:m.path,id:m.uid,display:m.display||m.text,photo:m.photo,category:m.category,cost:m.cost,idx:m.idx,tokens:m.tokens,type:m.untranslated_type||m.type,verticalType:m.vertical_type,subtext:m.text_only_subtext,logInfo:m.logInfo,bootstrapped:true,saved_context:m.saved_context};};};function l(){'use strict';j.apply(this,arguments);}f.exports=l;},null);
__d('MGraphSearchTypeaheadResult.react',['FacebarResultsTextHighlighter','React','cssURL','cx','MSearchConst'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=' \u00B7 ',n=i.createClass({displayName:'MGraphSearchTypeaheadResult',render:function(){var o=this.props.result.subtext,p=(this.props.query||'').toLowerCase(),q=this.props.result.display,r='';if(this.props.result.saved_context&&o){r=i.createElement('span',{className:"_2gau"},this.props.result.saved_context);o=m+o;}var s=this.props.forceLongBorder,t=this.props.vertical===l.feed_search&&this.props.result.type==='keyword',u="_1_oa"+(' '+"_1w-s")+(this.props.result.isTrending?' '+"_1_ob":'')+(this.props.result.isVerified?' '+"_21tt":'')+(this.props.result.showGrayCheck?' '+"_v27":'')+(!!o?' '+"_1_oc":'')+(this.props.result.photo!=null?' '+"_1_od":'')+(t?' '+"_18ka":'')+(s?' '+"_bmx":''),v="_5h5e"+(this.props.result.isTrending&&!this.props.result.isVerified?' '+"_22wu":'')+(!this.props.result.isTrending&&this.props.result.isVerified?' '+"_22wv":'')+(this.props.result.isTrending&&this.props.result.isVerified?' '+"_22ww":''),w=t,x=null;if(this.props.vertical!==l.content_search)x=i.createElement('div',{className:"_38c2",onTouchStart:this.props.onAddToInputClick,onMouseDown:this.props.onAddToInputClick});return (i.createElement('div',{className:u},i.createElement('div',{className:"_w_1"+(!s?' '+"_bmx":'')},i.createElement('a',{className:"touchable"+(' '+"_4rh3"),href:this.props.result.uriWithSession,onClick:this.props.onClick,rel:this.props.result.id,style:{display:this.props.visible?'':'none'}},i.createElement('i',{className:"img"+(t?' '+"_15i9":''),style:{display:w?'block':'none'}}),i.createElement('div',{className:"_1_oe"},i.createElement('span',{className:v},q),i.createElement('i',{className:"_21tu img"}),i.createElement('i',{className:"_v28 img"})),i.createElement('div',{className:"_1_og"},r,o),this.renderPhoto()),x)));},renderPhoto:function(){if(this.props.result.type==='trending')return (i.createElement('i',{className:"img _1_of _1_oh"}));var o=this.props.result.photo?j(this.props.result.photo):'none';return (i.createElement('i',{className:"_1_oh",style:{backgroundImage:o}}));}});f.exports=n;},null);
__d('MSearchComponentLogger',['Banzai','ge','Stratcom','Parent','DOM'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m='mtouch_search_component_logging',n='m-search-component-marker-sigil',o='click',p='impression';function q(r,s,t){'use strict';if(!r)return;this.logData=s;if(t){this.logData.unique_id=this.$MSearchComponentLogger1();this.$MSearchComponentLogger2();}this.sigils=r;this.$MSearchComponentLogger3=this.$MSearchComponentLogger3.bind(this);r.forEach((function(u){j.listen('click',u,this.$MSearchComponentLogger3);}).bind(this));}q.prototype.$MSearchComponentLogger1=function(r){'use strict';var s=Date.now();return this.logData.userid+this.logData.typeid+s;};q.prototype.$MSearchComponentLogger2=function(){'use strict';var r=this.logData;r.event=p;h.post(m,r,{delay:0,retry:true});};q.prototype.$MSearchComponentLogger4=function(r){'use strict';while(r){if(j.hasSigil(r,n))return r;if(r.getAttribute('data-sigil')){r=r.parentNode;}else r=k.byAttribute(r,'data-sigil');}return null;};q.prototype.$MSearchComponentLogger3=function(r){'use strict';var s=this.$MSearchComponentLogger4(r.getTarget());if(!s)return;var t=null;this.sigils.forEach(function(v){if(j.hasSigil(s,v))t=v;});this.logData.sigil=t;var u=this.logData;u.event=o;u=this.$MSearchComponentLogger5(u);h.post(m,u,{delay:0,retry:true});};q.prototype.$MSearchComponentLogger5=function(r){'use strict';var s=i('main-search-input');if(s){r.query=s.value;var t=k.byTag(s,'form'),u=l.scry(t,'input','search-typeahead-session-id')[0];if(u)r.tsid=u.value;}return r;};f.exports=q;},null);
__d('MSearchComponentLoggerHelper.react',['React','MSearchComponentLogger'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=h.createClass({displayName:'MSearchComponentLoggerHelper',componentWillMount:function(){var k={userid:this.props.userid,component_location:this.props.componentLocation,typeid:this.props.typeid,source:this.props.source};this.logger=new i(this.props.targetSigils,k,true);},render:function(){return this.props.children;}});f.exports=j;},null);
__d('MFeedSearchMegaphone.react',['React','cx','ix','fbt','MXUILayout.react','MXUILayoutFillColumn.react','MXUIButton.react','Image.react','MSearchComponentLoggerHelper.react'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q="m-nullstate-megaphone-close",r="m-nullstate-megaphone-take-tour",s='m-search-component-marker-sigil',t=h.createClass({displayName:'MFeedSearchMegaphone',render:function(){var u=j('/images/mobile/search/search_nullstate_mega_kayak.png'),v=j('/images/mobile/search/search_nullstate_mega_baseball.png');return (h.createElement(p,{userid:this.props.userid,componentLocation:'nullstate',typeid:'feed_search_megaphone',targetSigils:[q,r]},h.createElement('div',{className:"_qrv"},h.createElement('div',{className:"_qrw"},h.createElement('a',{href:'#','data-sigil':s+' '+q,onClick:this.props.onDismissClick},h.createElement(o,{src:j('/images/mobile/glyph/cross_dark-grey_m.png')}))),h.createElement('strong',null,k._("You can now find old posts, such as:")),h.createElement(l,null,h.createElement(m,{align:'center'},h.createElement('div',{className:"_qrx"},k._("kayak trip john smith")),h.createElement(o,{src:u})),h.createElement(m,{align:'center'},h.createElement('div',{className:"_qrx"},k._("baseball win dave")),h.createElement(o,{src:v}))),h.createElement('div',{className:"_21vt"},h.createElement(n,{use:'primary','data-sigil':s+' '+r,onClick:this.props.onActionClick},k._("Learn More"))))));}});f.exports=t;},null);
__d('MFeedSearchModeSwitch.react',['React','cx','ix','fbt','Image.react','MXUILayout.react','MXUILayoutFillColumn.react','MSearchComponentLoggerHelper.react'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p="m-nullstate-modeswitch-post",q="m-nullstate-modeswitch-simple",r='m-search-component-marker-sigil',s=h.createClass({displayName:'MFeedSearchModeSwitch',getInitialState:function(){return {simpleSearchMode:this.props.simpleSearchMode,hasResults:this.props.hasResults};},shouldComponentUpdate:function(t,u){return t.simpleSearchMode!==this.props.simpleSearchMode||t.hasResults!==this.props.hasResults;},render:function(){var t=this.props.simpleSearchMode?j('/images/mobile/search/search_mode_people_active.png'):j('/images/mobile/search/search_mode_people_inactive.png'),u=this.props.simpleSearchMode?j('/images/mobile/search/search_mode_post_inactive.png'):j('/images/mobile/search/search_mode_post_active.png'),v=this.props.tiny?null:h.createElement('div',{className:"_4y5n"},h.createElement(l,{src:t})),w=this.props.tiny?null:h.createElement('div',{className:"_4y5n"},h.createElement(l,{src:u})),x=this.props.tiny?k._("People & Pages"):k._("Search for people, places & things"),y=this.props.tiny?k._("Posts"):k._("Search for a post"),z=(this.props.tiny?"_1w8d":'')+(this.props.tiny&&this.props.hasResults?' '+"_1w8e":''),aa="_4y5m"+(this.props.simpleSearchMode?' '+"_1w8f":''),ba="_4y5p"+(!this.props.simpleSearchMode?' '+"_1w8f":'');return (h.createElement(o,{userid:this.props.userid,componentLocation:'nullstate',typeid:'feed_search_modeswitch',targetSigils:[p,q]},h.createElement(m,{className:z},h.createElement(n,{align:'center',className:aa},h.createElement('a',{href:'#','data-sigil':r+' '+q,onTouchStart:this.onMouseOrTouchDown,onMouseDown:this.onMouseOrTouchDown,onTouchEnd:this.onRegularSearchClick,onMouseUp:this.onRegularSearchClick},v,h.createElement('div',{className:"_4y5o"},x))),h.createElement(n,{align:'center',className:ba},h.createElement('a',{'data-sigil':r+' '+p,href:'#',onTouchStart:this.onMouseOrTouchDown,onMouseDown:this.onMouseOrTouchDown,onTouchEnd:this.onPostSearchClick,onMouseUp:this.onPostSearchClick},w,h.createElement('div',{className:"_4y5o"},y))))));},onRegularSearchClick:function(){this.props.onRegularSearchClick();},onPostSearchClick:function(){this.props.onPostSearchClick();},onMouseOrTouchDown:function(event){event.stopPropagation();event.preventDefault();}});f.exports=s;},null);
__d("XSearchFeedSearchMegaphoneDismissController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/search\/feed_search_megaphone\/dismiss\/",{});},null,{});
__d("XGroupSearchResultsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/groups\/search\/",{groupID:{type:"Int"},query:{type:"String"},name:{type:"String"},cursor:{type:"String"},source:{type:"String"}});},null,{});
__d('MGraphSearchTypeahead.react',['CSS','DOM','DOMContainer.react','LeftRight.react','MHistory','MPageController','MRequest','MSearchConst','MTouchClick','MViewport','Parent','React','ReactDOM','Stratcom','Style','SubscriptionsHandler','URI','$','arrayContains','csx','cx','fbt','getActiveElement','invariant','ix','throttle','MGraphSearchCompositeSource','MGraphSearchTypeaheadBucketizer','MGraphSearchTypeaheadHeaders','MGraphSearchTypeaheadOnDemandSource','MGraphSearchTypeaheadTouchSource','MGraphSearchTypeaheadResult.react','MGraphSearchUtils','MFeedSearchMegaphone.react','MFeedSearchModeSwitch.react','MRecentSearchesUpdater','MSearchTrendingLogger','MSearchTypeaheadLogger','MSearchTypeaheadPerfLogger','MTypeaheadNullstateSource','MTypeaheadOnDemandSource','MTypeaheadTouchSource','SearchMTouchGlobalOptions','TypeaheadCompositeSource','XSearchFeedSearchMegaphoneDismissController','Image.react','MJewel','MJewels','MContentSearchFilter','XGroupSearchResultsController','MNavTabs'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,ab,bb,cb,db,eb,fb){if(c.__markCompiled)c.__markCompiled();var gb=ja.Types,hb=ja.Labels,ib=[gb.TOP_MATCHES,gb.TRENDING],jb="/graphsearch/",kb="/keywords_",lb="keywords_top",mb='simple',nb='gsv2',ob='timeline',pb='group',qb=null,rb=null,sb=false,tb=s.createClass({displayName:'MGraphSearchTypeahead',getInitialState:function(){var ub=this.getInitialSearchMode(),vb=this.getInitialGroupID();return {query:this.props.prefilledValue||'',prefilledValue:this.props.prefilledValue||'',results:[],isWaiting:false,isActive:false,isVisible:this.props.prefilledValue!=null,resultClicked:false,showingFeedSearchMegaphone:this.props.hasFeedSearchMegaphone,searchMode:ub,prevSearchMode:ub,showModeSwitch:true,querySource:null,timelineID:this.getTimelineIDFromURI(),filterEnabled:false,qpMegaphoneDismissed:false,isInputFocused:false,groupID:vb,groupName:this.props.groupName};},shouldComponentUpdate:function(ub,vb){return vb.query!==this.state.query||vb.isWaiting!==this.state.isWaiting||vb.isActive!==this.state.isActive||vb.isVisible!==this.state.isVisible||vb.results.length!==this.state.results.length||vb.results.some((function(wb,xb){return wb.id!==this.state.results[xb].id||wb.display!=this.state.results[xb].display;}).bind(this))||vb.showingFeedSearchMegaphone!==this.state.showingFeedSearchMegaphone||vb.searchMode!==this.state.searchMode||vb.showModeSwitch!==this.state.showModeSwitch||vb.filterEnabled!==this.state.filterEnabled||vb.qpMegaphoneDismissed!==this.state.qpMegaphoneDismissed;},componentWillMount:function(){if(rb)this.applyPayload(rb);this._subscriptions=new w();this._bucketizer=new ia();this._datasource=null;this._listeners={};this._lastRenderedResult=[];this._datasourceCache=[];this._mSearchTypeaheadPerfLoggerConfigurationComplete=[];this._filters=this.props.filters;this.invokeQueryChangeThrottled=ga(this.invokeQueryChange,200);this.setResultsHeightThrottled=ga(this.setResultsHeight,500);if(this.props.filters)this._subscriptions.addSubscriptions(u.listen('m-content-search-filter-update',null,this.onFilterUpdate));if(this.props.qpMegaphone)this._subscriptions.addSubscriptions(u.listen('click','m-megaphone-close',this.onDismissQPMegaphone));if(this.props.typeaheadConfig.hasTopNavSearch)this._subscriptions.addSubscriptions(u.listen('setSearchText','graph-search-entry-point',this.onSetSearchText));this._subscriptions.addSubscriptions(u.listen(['m:chrome:tab:show','m:chrome:tab:hide'],cb.SEARCH,(function(event){var vb={isActive:event.getType()==='m:chrome:tab:show'};if(event.getData().open)vb.searchMode=this.getGlobalSearchMode();if(this.state.isVisible&&this.state.query===''&&this.state.prevQuery){vb.query=this.state.prevQuery;vb.searchMode=this.getInitialSearchMode();}this.setState(vb);if(vb.isActive){var wb=t.findDOMNode(this.refs.input);wb&&wb.focus();}else this.reset();if(event.getType()==='m:chrome:tab:hide')u.invoke('log-m-search-session-end',null,{reason:'navigated_away'});}).bind(this)),u.listen('m:page:loading',null,this.onMPageLoad),u.listen('click','m-timeline-search-dummy-box',this.onTimelineSearchActivation),u.listen('click','m-groups-scoped-search-button',this.onGroupSearchActivation));if(this.props.vertical===o.feed_search)this._subscriptions.addSubscriptions(u.listen('click','m-feed-search-nux-tryit',this.onFeedSearchNuxTryit),u.listen('click','m-search-keyword-pivot-link-permalink',this.onFeedSearchPermalinkPivotClick),u.listen('click','m-search-keyword-pivot-link-in_feed',this.onFeedSearchInFeedPivotClick),u.listen('click','m-search-keyword-pivot-link-timeline',this.onFeedSearchTimelinePivotClick),u.listen('click','m-feedsearch-megaphone-take-tour',this.onShowNux));var ub=db.getFilters();if(ub){i.setContent(this._filters.getContentRoot().querySelector("._5c0f"),ub);this.setState({filterEnabled:true});}},componentWillUnmount:function(){this._subscriptions.release();this._datasourceHandler.release();if(this._datasource!=null)this._datasource.unbindFromTypeahead();this._bucketizer=null;},componentDidMount:function(){!!qb?ea(0):undefined;qb=this;window.addEventListener('scroll',this.onWindowScroll,false);this.mGraphSearchTypeaheadContainer=r.byClass(t.findDOMNode(this),"_3qs0");if(this.props.nuxSearchFollow&&q.getScrollTop()<2){this.props.nuxSearchFollow.setContext(t.findDOMNode(this.refs.searchButtonDummy));this.props.nuxSearchFollow.show();}this.positionSearchBox();if(this.props.feedSearchInputNux)this._feedSearchInputNux=this.props.feedSearchInputNux;this._subscriptions.addSubscriptions(u.listen('m:graph-search:position-search-box',null,this.positionSearchBox),u.listen('keydown',null,this.onGlobalKeyDown),u.listen('MGraphSearchTypeahead:focus',null,this.onFocusRequest),u.listen('m:chrome:tab:show',null,this.onChromeTabShow));if(this.props.active)this.setState({query:this.props.prefilledValue||'',isActive:true,isVisible:true});},componentWillUpdate:function(ub,vb){this._invoke('render_start');if(this.state.searchMode!==ob&&vb.searchMode===ob&&vb.isVisible&&!this.state.isVisible)h.removeClass(this.mGraphSearchTypeaheadContainer,"_g9y");if(this.state.searchMode===ob&&vb.searchMode!==ob&&!vb.isVisible&&this.state.isVisible)h.addClass(this.mGraphSearchTypeaheadContainer,"_g9y");if(l.getParam(l.SOFT_STATE_KEY)!==cb.SEARCH&&!fb.hasNavTabs){var wb=i.find(y(bb.JEWEL_NAV_NODE_ID),'*','search');h.conditionClass(wb,'isActive',vb.isVisible);}},componentDidUpdate:function(ub,vb){this._lastRenderedResult=vb.results;if(this.state.isActive){this.setResultsHeightThrottled();}else if(vb.isActive&&!this.state.isActive)v.set(document.getElementById('page'),'height',null);if(!this._configurationDone&&!ub.isVisible&&this.state.isVisible){this.configureDatasource(xa);this.configureMSideNavMarauderLogger();this.configureMSearchTypeaheadLogger();this.configureMSearchTypeaheadPerfLogger();this.configureMRecentSearchesUpdater();var wb=p.hasTouchEvents()?'touchend':'click';u.invoke(wb,'graph-search-activator');this._invoke('change',[this.state.query]);this._configurationDone=true;}else if(vb.searchMode!==this.state.searchMode){this.configureDatasource(xa,true);this.configureMSearchTypeaheadPerfLogger();this.invokeQueryChange();}if(this.state.isActive&&this.state.searchMode===mb&&this.refs.results&&this.props.feedSearchModeSwitchNux&&this.state.query===''&&!this._feedSearchModeSwitchNux){var xb=t.findDOMNode(this.refs.results),yb=i.scry(xb,'*','m-nullstate-modeswitch-post');if(yb.length>0){this._feedSearchModeSwitchNux=this.props.feedSearchModeSwitchNux;this._feedSearchModeSwitchNux.setContext(yb[0]);this._feedSearchModeSwitchNux.updatePosition();this._feedSearchModeSwitchNux.show();}}if(this._feedSearchInputNux&&!this._feedSearchInputNux.isDestroyed()&&this.state.isActive&&this.state.searchMode===nb&&this.state.showModeSwitch){this._feedSearchInputNux.setContext(t.findDOMNode(this.refs.input));this._feedSearchInputNux.show();}this._invoke('rendered');},render:function(){var ub=this.props.typeaheadConfig.hasKeywordAffordance,vb=this.props.typeaheadConfig.hasXToClose,wb=this.props.typeaheadConfig.hasTopNavSearch,xb=this.props.typeaheadConfig.hasDropdownDesign,yb=!!this.props.filters&&this.state.filterEnabled&&!this.state.isActive,zb='';if(this.state.searchMode===ob){zb=ca._("Enter words from the post...");}else if(this.state.searchMode===pb){zb=ca._("Search in {groupName}",[ca.param('groupName',this.state.groupName)]);}else if(wb)zb=ca._("Search");var ac=s.createElement('form',{ref:'form',className:"_bjg",onSubmit:this.onFormSubmit,action:'/search'},s.createElement('div',{className:"_31vt",ref:'searchButtonDummy','data-sigil':'search-small-box-dummy',onClick:this.onSearchButtonDummyClick}),s.createElement('div',{ref:'inputWrapper',className:"_bjh"},s.createElement('div',{className:"_2chx"},s.createElement(ab,{src:fa('/images/mobile/search/post_token.png')})),s.createElement('input',{ref:'input',id:'main-search-input','data-sigil':'search-small-box',className:"_bji",type:'search',name:'query',placeholder:zb,autoComplete:'off',autoCorrect:'off',autoCapitalize:'off',onChange:this.onInputChange,onFocus:this.onInputFocus,onBlur:this.onInputBlur,value:this.state.query}),s.createElement('label',{htmlFor:'main-search-input',className:"_3a7l"},ca._("Search")),s.createElement('a',{href:'#',className:"_bjj",style:{display:!vb&&(!this.state.query||!this.state.isInputFocused)?'none':''},role:'button',onMouseDown:this.onClearButtonEvent,onTouchStart:this.onClearButtonEvent},'Ã—')),s.createElement('a',{href:'#',className:"_mq5",'data-sigil':'touchable m_content_search_filter_button',style:{display:yb?'block':'none'},role:'button'})),bc=this.props.vertical===o.feed_search,cc=this.state.isActive&&this.state.query===''&&this.state.showingFeedSearchMegaphone,dc=this.props.hasFeedSearchModeSwitch&&this.state.isActive&&this.state.showModeSwitch&&this.state.searchMode!==ob&&this.state.searchMode!==pb,ec="_djv"+(this.state.searchMode===ob?' '+"_25dh":'')+(!this.state.isActive?' '+"_bjm":'')+(this.state.isActive?' '+"_bjn":'')+(this.state.query&&this.state.query!==''?' '+"_xg3":'')+(this.state.isWaiting&&!bc?' '+"_bjo":'')+(this.state.isVisible?' '+"_bjp":'')+(!this.state.isVisible?' '+"_bjq":'')+(wb?' '+"_5ek4":'')+(!wb?' '+"_5ek5":'')+(ub?' '+"_3gwg":'')+(xb?' '+"_4rh2":'')+(cc?' '+"_2chy":'')+((this.state.isActive||this.state.isVisible)&&this.props.hasFeedSearchModeSwitch&&this.state.searchMode===nb&&!this.props.hasFeedSearchModeSwitchV2?' '+"_2chz":'')+(this.props.hasFeedSearchModeSwitchV2?' '+"_39ff":'')+(this.props.vertical===o.content_search?' '+"_2c_g":'')+(yb?' '+"_mq6":''),fc=this.renderResultsComponents(),gc=null;if(dc&&!this.props.hasFeedSearchModeSwitchV2){gc=s.createElement(pa,{ref:'results',userid:this.props.userid,simpleSearchMode:this.state.searchMode===mb,onRegularSearchClick:this.onRegularSearchClick,onPostSearchClick:this.onPostSearchClick});}else if(cc){var hc=false;if(!this.feedSearchMegaphoneImpressionLogged){hc=true;this.feedSearchMegaphoneImpressionLogged=true;}gc=this.feedSearchMegaphone=s.createElement(oa,{ref:'results',userid:this.props.userid,logImpression:hc,onDismissClick:this.onMegaphoneCloseClick,onActionClick:this.onMegaphoneActionClick});}else{var ic=null,jc=null;if(this.props.hasFeedSearchModeSwitchV2&&dc){ic=s.createElement(pa,{tiny:true,userid:this.props.userid,hasResults:this.state.query!=='',simpleSearchMode:this.state.searchMode===mb,onRegularSearchClick:this.onRegularSearchClick,onPostSearchClick:this.onPostSearchClick});if(this.state.query===''&&this.state.searchMode===nb)jc=s.createElement('div',{className:"_39fg"},ca._("Enter words that you remember from the post."));}var kc=null;if(this.props.qpMegaphone&&!this.state.qpMegaphoneDismissed)kc=s.createElement('div',{className:"_406x"},s.createElement(j,null,this.props.qpMegaphone));gc=s.createElement('div',{ref:'results',className:"_bjs"},ic,jc,kc,fc);}return (s.createElement('div',{className:ec},ac,s.createElement('div',{className:"_bjr",onTouchMove:this.onResultsWrapperTouchMove,onTouchStart:this.onResultsWrapperTouchMove},gc)));},onGlobalKeyDown:function(ub){if(ub.getSpecialKey()==='delete'&&this.state.isActive&&this.state.query===''&&this.state.searchMode===nb&&this.props.hasFeedSearchModeSwitch&&!this.props.hasFeedSearchModeSwitchV2&&t.findDOMNode(this.refs.input)===da()){if(this._feedSearchInputNux){this._feedSearchInputNux.hide();this._feedSearchInputNux=null;}this.setState({searchMode:mb});}},onChromeTabShow:function(event){if(event.path==='search')this.setState({isActive:true,isVisible:true},function(){t.findDOMNode(this.refs.input).focus();});},onFocusRequest:function(){t.findDOMNode(this.refs.input).focus();},onRegularSearchClick:function(){this.setState({query:this.state.searchMode===mb||this.props.hasFeedSearchModeSwitchV2?this.state.query:'',searchMode:mb,showModeSwitch:true});t.findDOMNode(this.refs.input).focus();},onPostSearchClick:function(){this.setState({query:this.state.searchMode===nb||this.props.hasFeedSearchModeSwitchV2?this.state.query:'',searchMode:nb,showModeSwitch:true});t.findDOMNode(this.refs.input).focus();},onDismissQPMegaphone:function(){if(!this.state.isVisible)return;this.setState({qpMegaphoneDismissed:true});},dismissMegaphone:function(){var ub=za.getURIBuilder().getURI();this.setState({showingFeedSearchMegaphone:false});new n(ub).setMethod('post').send();},onMegaphoneActionClick:function(){this.props.feedSearchNux.show();},onMegaphoneCloseClick:function(){this.dismissMegaphone();t.findDOMNode(this.refs.input).focus();},onTimelineSearchActivation:function(ub){var vb=r.byClass(ub.getTarget(),"_25dl"),wb=vb.getAttribute('data-sigil');if(!wb)return;this.setState({searchMode:ob,timelineID:wb,isVisible:true,isActive:true,showModeSwitch:false,refURI:window.location.href,results:[]});t.findDOMNode(this.refs.input).focus();},onGroupSearchActivation:function(ub){var vb=ub.getTarget(),wb=vb.getAttribute('data-ft'),xb=vb.getAttribute('data-name');if(!wb||!xb)return;this.setState({searchMode:pb,groupID:wb,groupName:xb,isVisible:true,isActive:true,showModeSwitch:false,refURI:window.location.href,results:[]});t.findDOMNode(this.refs.input).focus();},tryFeedSearch:function(ub,vb){if(!ub)ub='';if(!vb)vb=null;if(this.state.showingFeedSearchMegaphone)this.dismissMegaphone();this.setState({searchMode:this.props.hasFeedSearchModeSwitch?nb:this.state.searchMode,isVisible:true,isActive:true,query:ub,querySource:vb,showModeSwitch:ub===''||this.props.hasFeedSearchModeSwitchV2});t.findDOMNode(this.refs.input).focus();},onFeedSearchNuxTryit:function(){this.tryFeedSearch();},onFeedSearchPivotClick:function(ub,vb){var wb=r.byClass(ub.getTarget(),"_182_"),xb=i.find(wb,'span','m-feedsearch-pivot-keyword');this.tryFeedSearch(xb.innerText,vb);},onFeedSearchPermalinkPivotClick:function(ub){this.onFeedSearchPivotClick(ub,'feed_search_permalink_pivot');},onFeedSearchInFeedPivotClick:function(ub){this.onFeedSearchPivotClick(ub,'feed_search_in_feed_pivot');},onFeedSearchTimelinePivotClick:function(ub){this.onFeedSearchPivotClick(ub,'feed_search_timeline_pivot');},onShowNux:function(){this.props.feedSearchNux.show();},getHeaderTypeForResult:function(ub,vb){if(ub.isTrending){return gb.TRENDING;}else if(ub.isRecentSearch){return gb.RECENT;}else if(ub.type==='keyword'){return gb.SUGGESTED;}else return gb.TOP_MATCHES;},renderResultsComponents:function(){var ub=this._bucketizer.bucketize(this.state.results),vb=false,wb=false,xb=[],yb=[],zb=-1,ac=[],bc=true,cc=0,dc=this.state.query.toLowerCase().trim();Object.keys(ub).forEach((function(fc){var gc=ub[fc];if(fc===gb.SUGGESTED&&gb.GROUP_SEARCH in ub)fc=gb.SUGGESTED_GLOBAL;ac.push(this.renderHeader(fc,bc));bc=false;var hc=gc.map((function(ic,jc){if(ic.type==='keyword'){wb=true;if(ic.display&&ic.display.toLowerCase().trim()===dc)vb=true;}if(this.state.isVisible&&ic.isTrending){xb[cc]=ic.topicID;yb[cc]=cc+1;zb=ic.trendingQueryID;}var kc=z(ib,fc)||jc===gc.length-1;return this.renderResult(cc++,kc);}).bind(this));ac.push.apply(ac,hc);}).bind(this));if(xb.length>0&&!sb){sb=true;ra.registerTrendingTopicListeners(xb,o.msite_news_null_state,yb,zb);ra.logTrendingTopicImpressions(xb,o.msite_news_null_state,yb,zb);}else sb=false;var ec=this.getEchoQuery(vb,wb);if(ec){if(this.state.query!==''&&this.props.vertical===o.content_search&&!ub[gb.SUGGESTED])ac.push(this.renderHeader(gb.SUGGESTED,bc));ac.push(ec);}return ac;},getEchoQuery:function(ub,vb){if(this.state.searchMode===ob)return this.renderSeeMore();if(this.props.vertical===o.content_search||this.props.vertical===o.feed_search){if(this.state.searchMode===mb){return this.renderSeeMore(true);}else if(!ub&&(!vb||!this.props.removeEchoQuery))return this.renderSeeMore();return null;}return this.renderSeeMore();},positionSearchBox:function(){v.set(t.findDOMNode(this),'top',q.getHeaderTop()+'px');},getSeeMoreText:function(ub){if(this.props.simpleSearch||ub)if(this.props.vertical===o.content_search){return ca._("See more results");}else return ca._("See more results for {query}",[ca.param('query','"'+this.state.query+'"')]);if(this.state.searchMode===ob||this.props.vertical===o.content_search)return this.state.query;if(this.props.vertical===o.feed_search)if(this.props.hasFeedSearchTypeaheadSuggestions){return this.state.query;}else return ca._("Find posts for {query}",[ca.param('query','"'+this.state.query+'"')]);var vb=this.state.query.trim();return ca._("Search for {query}",[ca.param('query','"'+vb+'"')]);},getDefaultSource:function(){return this.state.querySource?this.state.querySource:'typeahead';},renderSeeMore:function(ub){var vb=this.getSeeMoreURI(this.state.query,ub).addQueryData('tsid',this._sessionID).addQueryData('source',this.getDefaultSource()).toString(),wb=ub?this.onSimpleSearchSeeMoreClick:this.onSeeMoreClick,xb=false;if(this.props.vertical===o.content_search||this.props.vertical===o.feed_search)xb=!this.props.hasFeedSearchModeSwitch||!ub;return (s.createElement('a',{className:"_1_oa"+(!xb?' '+"_bju":'')+(' '+"touchable"),'data-sigil':'touchable',href:vb,key:'see-more',onClick:wb,style:{display:!this.state.query?'none':''}},s.createElement('i',{className:"img"+(' '+"_15i9"),style:{display:this.state.searchMode===mb||ub||this.props.vertical===o.content_search?'none':''}}),s.createElement('div',{className:"_1_oe"+(this.state.searchMode!==mb&&!ub?' '+"_15ia":'')},this.getSeeMoreText(ub))));},renderResult:function(ub,vb){var wb=this.state.results[ub],xb=wb!=null,yb='typeahead';if(xb&&wb.uri)if(this.redirectPages&&wb.type=='page'){wb.uriWithSession=new x('/search/').addQueryData('query',wb.name).addQueryData('tsid',this._sessionID).addQueryData('source',yb).toString();}else wb.uriWithSession=new x(wb.uri).addQueryData({tsid:this._sessionID,source:yb}).toString();if(!xb)wb=this._lastRenderedResult[ub]||{};if(wb.isTrending)wb.uriWithSession=new x(wb.uriWithSession).addQueryData('position',ub+1).toString();return (s.createElement(ma,{key:wb.id,onAddToInputClick:this.onAddToInputClick,onClick:this.onResultClick,query:this.state.query,result:wb,vertical:this.props.vertical,visible:xb,forceLongBorder:vb}));},renderHeader:function(ub,vb){if(ub===gb.RECENT)return this.renderRecentHeader();if(this.state.query===''||this.state.searchMode===pb){return (s.createElement('div',{className:"_tn0",key:ub},hb[ub]));}else if(!vb)return (s.createElement('div',{className:"_2p41",key:ub}));},renderRecentHeader:function(){return (s.createElement(k,{key:gb.RECENT,direction:'right',className:"_tn0"},hb[gb.RECENT],s.createElement('a',{href:this.props.activityLogURI,onClick:this.onEditRecentClick,className:"_2186"},ca._("Edit"))));},onEditRecentClick:function(){this.recentSearchesNeedsUpdate=true;},clear:function(){var ub=t.findDOMNode(this.refs.input),vb='';ub.value=vb;this.setState({query:vb,showModeSwitch:true});this._invoke('change',[vb]);this._invoke('update',[vb]);},cancel:function(){var ub=t.findDOMNode(this.refs.input);ub.blur();u.invoke('log-m-search-session-end',null,{reason:'cancel'});var vb=this.state.prefilledValue||'';this.setState({query:vb,isActive:false,isVisible:!!vb,searchMode:this.getInitialSearchMode()});this._invoke('change',[vb]);this._invoke('update',[vb]);},getValue:function(){return t.findDOMNode(this.refs.input).value;},getDatasource:function(){return this._datasource;},_setDatasource:function(ub){this._datasource=ub;this._datasourceHandler=new w();this._datasourceHandler.addSubscriptions(ub.listen('waiting',this.onDatasourceWaiting),ub.listen('resultsready',this.onDatasourceResultsReady),ub.listen('complete',this.onDatasourceComplete));ub.bindToTypeahead(this);},_getTypeaheadConfig:function(){if(this.props.timelineSearchTypeaheadConfig&&this.state.searchMode===ob)return this.props.timelineSearchTypeaheadConfig;if(!this.props.simpleSearchTypeaheadConfig||this.props.vertical===o.content_search)return this.props.typeaheadConfig;return this.state.searchMode===mb?this.props.simpleSearchTypeaheadConfig:this.props.typeaheadConfig;},_getDatasourceCacheKey:function(){return this.state.searchMode;},configureDatasource:function(ub,vb){if(this._datasource!=null&&!vb)return;if(this._datasource!=null){this._datasourceHandler.release();this._datasource.unbindFromTypeahead();}var wb=this._getDatasourceCacheKey(),xb=this._datasourceCache[wb];if(xb){this._setDatasource(xb);this._invoke('refresh');return;}var yb=this._getTypeaheadConfig().sources,zb=[],ac;if(yb.bootstrapped&&this.state.searchMode!==pb&&(!this.props.hasFeedSearchModeSwitch||this.state.searchMode===mb)){ac=this.getTypeaheadTouchSource(yb.bootstrapped.src,yb.bootstrapped.source_key,this.props.suggestions);ac.setShowSecondaryAction(true);ac.reactRendered=true;this.touchSource=ac;zb.push(ac);}if(yb.nullstate&&this.props.vertical!==o.feed_search){this.nullstateDataSource=this.getTypeaheadNullstateSource(yb.nullstate.src);this.nullstateDataSource.setMaximumResultCount(yb.nullstate.max_results);this.nullstateDataSource.setShowSecondaryAction(true);this.nullstateDataSource.reactRendered=true;this.nullstateDataSource.setCurrentProfileID(this.props.currentProfileID);if(this.props.hasFeedSearchModeSwitch)this.nullstateDataSource.setForceDisableSingleState(this.state.searchMode===mb);if(this.state.searchMode===pb)this.nullstateDataSource.setEnableScoped(true);zb.push(this.nullstateDataSource);}var bc=yb.online;if(this.props.hasFeedSearchModeSwitch&&this.props.vertical===o.content_search&&this.state.searchMode===mb)bc=yb.online_entities;if(bc){ac=this.getTypeaheadOnDemandSource(bc.src);ac.setMaximumResultCount(bc.max_results);ac.setEnableImmediateReturnOfCachedResults(bc.enable_caching);if(ub){if(ub.enableQueryThrottle)ac.setThrottleSendRequest(ub.queryThrottleTime);ac.setMaxResults(ub.maxResults);ac.setEnableEagerSendRequest(ub.enableEagerSendRequest);ac.setQueryDelay(ub.queryWaitTime);this.redirectPages=ub.redirectPages;}ac.setShowSecondaryAction(true);ac.reactRendered=true;zb.push(ac);}var cc=this.getTypeaheadCompositeSource(zb);cc.reactRendered=true;cc.mergeKey='id';this._setDatasource(cc);this._invoke('start');this._datasourceCache[wb]=this._datasource;},getTypeaheadCompositeSource:function(ub){if(this.state.searchMode===mb&&this.props.vertical!==o.content_search)return new ya(ub);var vb=new ha(ub);vb.setConfig(this.props.typeaheadConfig.compositeSourceConfig);return vb;},getTypeaheadOnDemandSource:function(ub){if(this.state.searchMode===mb&&this.props.vertical!==o.content_search)return new va(ub);ub=new ka(ub,{disableLongerQueryCacheHit:this.props.typeaheadConfig.disableLongerQueryCacheHit});if(this.state.searchMode===pb){ub.setIsScoped(true);ub.setGroupID(this.state.groupID);}return ub;},getTypeaheadTouchSource:function(ub,vb){if(this.state.searchMode===mb)return new wa(ub,vb);return new la(ub,vb);},getTypeaheadNullstateSource:function(ub){return new ua(ub);},getTypeaheadType:function(){var ub='m_top_nav';if(this.props.simpleSearch){ub+='_simple';}else ub+='_gsv2';if(this.props.typeaheadConfig.hasTopNavSearch)ub+='_small_box';return ub;},configureMSideNavMarauderLogger:function(){if(!this.props.typeaheadConfig.mSideNavMarauderLogger||this._mSideNavMarauderLoggerConfigurationComplete)return;this.props.typeaheadConfig.mSideNavMarauderLogger.setupTypeaheadListener(this);this._mSideNavMarauderLoggerConfigurationComplete=true;},configureMSearchTypeaheadLogger:function(){if(this._mSearchTypeaheadLoggerConfigurationComplete)return;this._subscriptions.addSubscriptions(u.listen('m-typeahead-logger:new-session-id',null,this.onMTypeaheadLoggerNewSessionId));var ub='/search/metrics.php',vb=new sa(this,ub);this._mSearchTypeaheadLoggerConfigurationComplete=true;this._subscriptions.addSubscriptions(u.listen('log-m-search-session-end',null,function(wb){vb.blur(wb.getData().reason);}));},configureMRecentSearchesUpdater:function(){if(this.props.typeaheadConfig.hasRecentSearches)new qa(this);},configureMSearchTypeaheadPerfLogger:function(){var ub=this._getDatasourceCacheKey();if(!this.props.typeaheadConfig.typeaheadScubaInfo||this._mSearchTypeaheadPerfLoggerConfigurationComplete[ub])return;new ta(this,this.props.typeaheadConfig.typeaheadScubaInfo,this.props.typeaheadConfig.sources.online.enable_caching);this._mSearchTypeaheadPerfLoggerConfigurationComplete[ub]=true;},invokeKeypressed:function(){var ub=t.findDOMNode(this.refs.input).value;this._invoke('keypress',[ub]);},invokeQueryChange:function(){var ub=t.findDOMNode(this.refs.input).value;this._invoke('update',[ub]);this._invoke('change',[ub]);},listen:function(ub,vb){this._listeners[ub]=this._listeners[ub]||[];this._listeners[ub].push(vb);return {type:ub,callback:vb,remove:(function(){this._listeners[ub]=this._listeners[ub].filter(function(wb){return wb!==vb;});}).bind(this)};},_invoke:function(ub,vb){if(this._listeners[ub])this._listeners[ub].forEach((function(wb){wb.apply(this,vb);}).bind(this),this);},onInputChange:function(){var ub=t.findDOMNode(this.refs.input).value;if(this._feedSearchModeSwitchNux)this._feedSearchModeSwitchNux.hide();if(this._feedSearchInputNux)this._feedSearchInputNux.hide();if(this.state.searchMode===mb&&(ub==='post: '||ub==='posts: ')){this.setState({query:'',searchMode:nb,showModeSwitch:true});return;}this.setState({query:ub,showModeSwitch:ub===''||this.props.hasFeedSearchModeSwitchV2,querySource:null});this.invokeKeypressed();this.invokeQueryChangeThrottled();},onInputBlur:function(){this.setState({isInputFocused:false});},onInputFocus:function(){this.setState({isInputFocused:true});if(!fb.hasNavTabs)l.pushSoftState(cb.SEARCH);var ub=t.findDOMNode(this.refs.input).value,vb=new x(window.location),wb=new x(this.props.activityLogURI);if(this.recentSearchesNeedsUpdate||vb.getPath()===wb.getPath()){this.recentSearchesNeedsUpdate=false;this._invoke('refreshRecent',[ub]);}var xb=!this.state.isActive||ub===''||this.state.showModeSwitch;this.setState({isActive:true,isVisible:true,showModeSwitch:xb,prevSearchMode:this.state.searchMode});if(this._configurationDone){var yb=p.hasTouchEvents()?'touchend':'click';u.invoke(yb,'graph-search-activator');}this._invoke('focus');this._invoke('change',[ub]);},onClearButtonEvent:function(event){event.preventDefault();var ub=this.props.typeaheadConfig.hasXToClose,vb=t.findDOMNode(this.refs.input);if(ub&&vb.value===''){this.cancel();}else t.findDOMNode(this.refs.input).focus();this.setState({prevQuery:this.state.query});this.clear();},onResultClick:function(event){var ub=this.getResultLinkFromTarget(event.target),vb=this.getResultFromResultLink(ub),wb={isActive:false,isVisible:vb.type==='keyword',resultClicked:true};wb.query=vb.type==='keyword'?vb.display:'';wb.prefilledValue=wb.query;this.setState(wb);this._invoke('select',[ub]);},onAddToInputClick:function(event){event.preventDefault();event.stopPropagation();var ub=this.getResultFromResultLink(this.getResultLinkFromTarget(event.target)),vb=ub.display+' ';this._invoke('change',[vb]);this.setState({query:vb});},onSeeMoreClick:function(){this.handleSeeMoreClick(false);},onSimpleSearchSeeMoreClick:function(){this.handleSeeMoreClick(true);},handleSeeMoreClick:function(ub){var vb=t.findDOMNode(this.refs.input),wb=vb.value;this.setState({resultClicked:true,prefilledValue:wb,isActive:false,isVisible:!!wb});var xb='';if(this.props.vertical===o.feed_search)xb=ub?'keyword_find_other_results':'keyword_feed_search';this._invoke('query',[this.state.results,xb]);},onFormSubmit:function(event){event.preventDefault();var ub=t.findDOMNode(this.refs.input),vb=ub.value,wb='';if(vb==='')return false;if(this.state.searchMode!==pb){vb=encodeURIComponent(vb);vb=vb.replace(/%/g,'%25');}wb=this.getSubmitURI(vb);wb=wb.addQueryData('tsid',this._sessionID).addQueryData('source',this.getDefaultSource()).toString();m.load(wb);this.setState({prefilledValue:vb,isActive:false,isVisible:!!vb,resultClicked:true});this._invoke('query',[this.state.results]);ub.blur();},getGraphSearchURI:function(ub){ub=ub.trim();if(this.state.searchMode===pb)return eb.getURIBuilder().setInt('groupID',this.state.groupID).setString('query',ub).getURI();var vb=na.normalizeQuery(ub);if(this.props.vertical===o.content_search&&this.props.hasFeedSearchModeSwitch&&lb==='keywords_top')lb='keywords_posts';var wb=new x(window.location),xb=wb.getPath();if(xb.indexOf(jb)===0&&xb.lastIndexOf(kb)!=-1&&this.props.vertical!==o.content_search){lb=xb.substring(xb.lastIndexOf(kb)+1);var yb=lb.indexOf('/');if(yb!==-1)lb=xb.substring(0,yb);}return new x('/graphsearch/str/'+vb+'/'+lb);},getSubmitURI:function(ub){switch(this.state.searchMode){case mb:return this.getSeeMoreURI(ub,true);case ob:return this.getSeeMoreURI(ub);default:return this.getGraphSearchURI(ub).addQueryData('ref','content_filter');}},getSeeMoreURI:function(ub,vb){ub=ub.trim();vb=vb||false;if(this.props.hasGSv2EntityMode&&(vb||this.state.searchMode===mb)){var wb=na.normalizeQuery(ub);return new x('/graphsearch/str/'+wb+'/keywords_entities');}if(!vb&&this.state.searchMode===nb)return this.getGraphSearchURI(ub);var xb=new x('/search/?query').addQueryData({query:ub,refid:o.refid});if(this.state.searchMode===ob)xb.addQueryData('timeline_id',this.state.timelineID);return xb;},getTimelineURI:function(){return this.state.refURI?this.state.refURI:this.state.timelineID?new x('/'+this.state.timelineID):'#';},onResultsWrapperTouchMove:function(){t.findDOMNode(this.refs.input).blur();},onSearchButtonDummyClick:function(){if(this.props.nuxSearchFollow)this.props.nuxSearchFollow.hide();t.findDOMNode(this.refs.input).focus();},onDatasourceWaiting:function(){this.setState({isWaiting:true});},injectKeywordEchoQuery:function(ub){if(this.state.query===''||this.props.vertical!==o.content_search||this.props.removeEchoQuery||this.props.hasFeedSearchModeSwitch&&this.state.searchMode===mb)return ub;var vb=[],wb=false;for(var xb=0;xb<ub.length;xb++){var yb=ub[xb];if(yb&&yb.type==='keyword'&&yb.display&&yb.display.toLowerCase().trim()===this.state.query.toLowerCase().trim())wb=true;var zb=null;if(xb+1<ub.length)zb=ub[xb+1];vb.push(yb);if(!wb&&(xb===ub.length-1||yb.type==='keyword'&&zb&&zb.type!=='keyword')){var ac=this.getSeeMoreURI(this.state.query).toString();vb.push({id:'echo-query',type:'keyword',display:this.getSeeMoreText(),uri:ac});wb=true;}}return vb;},onDatasourceResultsReady:function(ub){this.setState({results:this.injectKeywordEchoQuery(ub)});ub.forEach(function(vb){vb.uri=new x(vb.uri).addQueryData('refid',o.refid);return vb;});this._invoke('show',[ub]);},onDatasourceComplete:function(){this.setState({isWaiting:false});},onFilterUpdate:function(event){var ub=db.getFilters();if(!ub)return;i.setContent(this._filters.getContentRoot().querySelector("._5c0f"),ub);this.setState({filterEnabled:true});},onSetSearchText:function(event){var ub=event.getData().title||'';this._invoke('change',[ub]);this.setState({query:ub,prefilledValue:ub,isActive:false,isVisible:ub!=='',searchMode:this.getInitialSearchMode(),timelineID:this.getTimelineIDFromURI()});},onMTypeaheadLoggerNewSessionId:function(ub){if(!this.refs||!this.refs.form)return;var vb=t.findDOMNode(this.refs.form),wb=i.scry(vb,'input','search-typeahead-session-id')[0];if(!wb){wb=document.createElement('input');wb.type='hidden';wb.name='tsid';vb.appendChild(wb);u.addSigil(wb,'search-typeahead-session-id');}var xb=ub.getData().sessionID;wb.value=xb;this._sessionID=xb;},onWindowScroll:function(event){if(this.state.isVisible)this._invoke('scroll',[event]);},onMPageLoad:function(){if(this._filters){this._filters.hide();this.setState({filterEnabled:false});}setTimeout(this.reset);},reset:function(){var ub=t.findDOMNode(this.refs.input);if(ub!=null)ub.blur();if(!this.state.resultClicked){this.setState({isVisible:false,isActive:false,query:'',prefilledValue:'',searchMode:this.getInitialSearchMode()});}else this.setState({resultClicked:false});},getResultLinkFromTarget:function(ub){var vb=r.byClass(ub,"_1w-s");return vb.querySelector("._4rh3");},getResultFromResultLink:function(ub){var vb=this.state.results.filter(function(wb){return wb.id===ub.getAttribute('rel');})[0]||{};return vb;},setResultsHeight:function(){var ub=t.findDOMNode(this.refs.results).offsetHeight+t.findDOMNode(this.refs.results).offsetTop;if(ub){var vb=t.findDOMNode(this.refs.form).offsetHeight;v.set(document.getElementById('page'),'height',ub+vb+'px');}},applyPayload:function(ub){if(ub.active)u.listen(['m:onload','m:page:render:complete'],null,(function(){u.removeCurrentListener();rb=null;var vb=this.state.searchMode;if(this.props.hasFeedSearchModeSwitch)vb=ub.postsearchmode?nb:mb;this.setState({isActive:true,isVisible:true,searchMode:vb});}).bind(this));},getInitialSearchMode:function(){var ub=new x(window.location),vb=this.getSpecialSearchMode(ub);if(vb!==undefined)return vb;var wb=ub.getPath();return this.getGlobalSearchMode(wb);},getSpecialSearchMode:function(ub){if(ub.getQueryData().timeline_id){return ob;}else if(ub.getQueryData().groupID)return pb;},getGlobalSearchMode:function(ub){if(ub===undefined){var vb=new x(window.location);ub=vb.getPath();}if(this.props.simpleSearch||(this.props.vertical===o.feed_search||this.props.vertical===o.content_search)&&ub.indexOf(jb)===-1&&this.props.hasFeedSearchModeSwitch)return mb;return nb;},getInitialGroupID:function(){var ub=new x(window.location);return ub.getQueryData().groupID;},getTimelineIDFromURI:function(){return new x(window.location).getQueryData().timeline_id;}});tb.update=function(ub){if(qb&&ub){qb.applyPayload(ub);}else rb=ub;};f.exports=tb;},null);